
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <link rel="icon" type="image/x-icon" href="assets/favicon.png">
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ â€” MZJ Workspace</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--brown:#3e2420;--beige:#bc8f74;--cream:#fff8ef;--text:#1f2937;--muted:#6b7280;--radius:14px}
    *{box-sizing:border-box}
    body{margin:0;background:var(--cream);color:var(--text);font-family:"Tajawal",system-ui,Arial}
    a{color:inherit;text-decoration:none}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;background:var(--brown);color:#fff;position:sticky;top:0;z-index:10;box-shadow:0 6px 20px rgba(62,36,32,.2)}
    .brand{display:flex;align-items:center;gap:10px}
    .brand-badge{inline-size:28px;block-size:28px;border-radius:8px;background:linear-gradient(135deg,var(--beige),#d9b39a)}
    .nav{display:flex;gap:10px;align-items:center}
    .nav a{padding:8px 12px;border-radius:10px;color:#fff}
    .nav a:hover{background:rgba(255,255,255,.14)}
    .page{padding:18px;display:grid;gap:16px}
    .panel{background:#fff;border-radius:var(--radius);box-shadow:0 12px 30px rgba(62,36,32,.12);overflow:hidden}
    .panel .head{padding:12px 14px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
    .panel .body{padding:12px 14px}
    .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--brown);color:#fff;font-weight:700;cursor:pointer}
    .btn.secondary{background:#fff;color:var(--brown);border:1px solid var(--brown)}
    .btn.small{font-size:13px;padding:6px 10px}
    .input,.select{padding:10px;border-radius:10px;border:1px solid #ddd;font-family:inherit}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #f3e7e0;text-align:right}
    th{background:#fff8ef;color:var(--brown);font-weight:800}
    tr:hover td{background:#fffdf9}
    .badge{padding:4px 8px;border-radius:999px;font-size:12px;background:#f7e9e0;color:var(--brown)}
    .muted{color:var(--muted)}
    footer{padding:16px 18px;color:#fff;background:linear-gradient(180deg,var(--brown),#2f1c19);margin-top:8px}
  </style>
<style>
/* ===== Premium 3: Apple-like Glass (Brand Edition) ===== */
:root{
  --brown:rgb(62,36,32);
  --beige:rgb(188,143,116);
  --cream:#fff8ef;

  --bg:#eef0f3;
  --text:#0f172a;
  --muted:#64748b;

  --glass:rgba(255,248,239,.58);
  --glass-strong:rgba(255,248,239,.72);
  --stroke:rgba(62,36,32,.14);
  --shadow:rgba(15,23,42,.14);
  --radius:16px;
}

html,body{
  background:
    radial-gradient(1200px 800px at 20% 10%, rgba(188,143,116,.32), transparent 55%),
    radial-gradient(1200px 800px at 80% 0%, rgba(62,36,32,.18), transparent 55%),
    var(--bg)!important;
  color:var(--text)!important;
  font-family:'Tajawal',system-ui,sans-serif;
}

header,.topbar{
  background:rgba(255,248,239,.55)!important;
  border-bottom:1px solid rgba(62,36,32,.10)!important;
  backdrop-filter:blur(18px);
  box-shadow:0 14px 34px rgba(15,23,42,.10)!important;
}

.mzj-wrap{max-width:1500px;margin:0 auto;padding:18px;}

/* Toggle */
.mzj-toggle{
  display:inline-flex;align-items:center;justify-content:center;
  width:46px;height:46px;border-radius:18px;
  color:var(--brown);font-weight:900;cursor:pointer;
  background:rgba(255,248,239,.62);
  backdrop-filter:blur(18px);
  border:1px solid rgba(62,36,32,.12);
  box-shadow:0 10px 26px rgba(15,23,42,.10);
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.mzj-toggle:hover{
  transform:translateY(-1px);
  border-color:rgba(188,143,116,.45);
  box-shadow:0 18px 38px rgba(15,23,42,.14);
}

/* Overlay */
.mzj-overlay{
  position:fixed;inset:0;background:rgba(15,23,42,.40);
  display:none;opacity:0;transition:opacity .18s ease;z-index:999;
}
.mzj-overlay.open{opacity:1;}

/* Sidebar */
.mzj-sidebar{
  position:fixed;top:0;right:0;height:100%;width:318px;
  background:rgba(255,248,239,.68);
  backdrop-filter:blur(20px);
  border-left:1px solid rgba(62,36,32,.12);
  transform:translateX(104%);
  transition:transform .22s cubic-bezier(.2,.8,.2,1);
  z-index:1000;padding:16px 14px;
  box-shadow:-28px 0 70px rgba(15,23,42,.14);
}
.mzj-sidebar.open{transform:translateX(0);}

.mzj-sb-head{
  display:flex;gap:10px;align-items:center;
  padding:10px 10px 14px;
  border-bottom:1px solid rgba(62,36,32,.08);
  margin-bottom:12px;
}
.mzj-sb-logo{
  width:44px;height:44px;border-radius:18px;
  background:linear-gradient(135deg, rgba(188,143,116,.55), rgba(255,248,239,.65));
  border:1px solid rgba(62,36,32,.10);
  display:flex;align-items:center;justify-content:center;
  color:var(--brown);font-weight:900;
  box-shadow:0 14px 34px rgba(15,23,42,.10);
}
.mzj-sb-title{font-weight:900;color:var(--brown);line-height:1}
.mzj-sb-sub{font-size:12px;color:rgba(62,36,32,.65);margin-top:2px;font-weight:700}

/* Nav items */
.mzj-sb-nav{padding:4px 8px}
.mzj-nav-item{
  display:flex;gap:10px;align-items:center;
  padding:12px 12px;border-radius:18px;
  color:var(--brown);
  text-decoration:none;
  background:rgba(255,248,239,.45);
  border:1px solid rgba(62,36,32,.08);
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
.mzj-nav-item:hover{
  transform:translateY(-1px);
  border-color:rgba(188,143,116,.45);
  background:rgba(255,248,239,.62);
  box-shadow:0 18px 40px rgba(15,23,42,.12);
}
.mzj-nav-item.active{
  background:linear-gradient(135deg, rgba(188,143,116,.28), rgba(255,248,239,.65));
  border-color:rgba(188,143,116,.55);
  box-shadow:0 18px 44px rgba(15,23,42,.14);
}
.mzj-nav-item svg{
  width:20px;height:20px;
  stroke:var(--beige);
  stroke-width:2;
  fill:none;
  flex:0 0 auto;
}
.mzj-nav-item.active svg{stroke:var(--brown);}

/* Footer */
.mzj-sb-foot{margin-top:14px;padding:12px 10px 0;border-top:1px solid rgba(62,36,32,.08);}
.mzj-sb-btn{
  width:100%;padding:12px;border-radius:18px;
  border:1px solid rgba(62,36,32,.14);
  background:rgba(255,248,239,.60);
  color:var(--brown);font-weight:900;cursor:pointer;
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.mzj-sb-btn:hover{
  transform:translateY(-1px);
  border-color:rgba(188,143,116,.55);
  box-shadow:0 16px 34px rgba(15,23,42,.12);
}

/* Press micro-interaction */
.pressed{transform:scale(.985)!important;}

/* Content cards */
.panel,.card,.board-column,.task,.item, .container, .box{
  background:rgba(255,248,239,.62)!important;
  backdrop-filter:blur(18px)!important;
  border:1px solid rgba(62,36,32,.10)!important;
  border-radius:var(--radius)!important;
  box-shadow:0 18px 46px rgba(15,23,42,.10)!important;
}
.panel:hover,.card:hover,.board-column:hover,.task:hover,.item:hover{
  transform:translateY(-2px);
  transition:transform .18s ease, box-shadow .18s ease;
  box-shadow:0 26px 70px rgba(15,23,42,.14)!important;
}

/* Inputs */
input,select,textarea{
  border-radius:14px!important;
  border:1px solid rgba(62,36,32,.14)!important;
  background:rgba(255,248,239,.72)!important;
}
button{border-radius:14px!important;}
</style>
</head>
<body>
  <header class="topbar">
    <div class="brand"><span class="mzj-toggle" id="mzjToggle">â˜°</span>
      <span class="brand-badge"></span>
      <strong>MZJ Workspace â€” Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</strong>
    </div>
    <nav class="nav">
      <a href="dashboard.html">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
      <a href="projects.html">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</a>
      <a href="members.html">Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</a>
      <a href="admin.html">Ø§Ù„Ø­Ù…Ù„Ø§Øª</a>
      <a href="cars.html">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</a>
      <a href="Whiteboard.html">ÙˆØ§ÙŠØª Ø¨ÙˆØ±Ø¯</a>
      <a href="javascript:void(0)" id="logoutBtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
    </nav>
  </header>

  <main class="page">
    <section class="panel">
      <div class="head">
        <strong>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</strong>
        <button class="btn small" id="btnAddUser">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</button>
      </div>
      <div class="body">
        <table id="membersTable">
          <thead>
            <tr>
              <th>Ø§Ù„Ø§Ø³Ù…</th>
              <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
              <th>Ø§Ù„Ø¯ÙˆØ±</th>
              <th>Ø§Ù„Ù„ÙˆÙ†</th>
              <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
              <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer>Â© Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø°Ø¹Ø§Ø± Ø§Ù„Ø¹Ø¬Ù…ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª â€” Ù†Ø¬Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚</footer>

  <script type="module">
    import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
    import { getFirestore, collection, getDocs, doc, updateDoc, setDoc, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBVNNtGz9zGefzmNIosRrwgJGROsu5SNIw",
      authDomain: "mzj-workspace.firebaseapp.com",
      projectId: "mzj-workspace",
      storageBucket: "mzj-workspace.firebasestorage.app",
      appId: "1:1043260904465:web:8742de3a3ac727ae1e8db0"
    };

    if(!getApps().length) initializeApp(firebaseConfig);
    const auth = getAuth();
    const db = getFirestore();

    const membersTable = document.querySelector('#membersTable tbody');
    const logoutBtn = document.getElementById('logoutBtn');
    const addBtn = document.getElementById('btnAddUser');

    logoutBtn.onclick = async ()=>{ await signOut(auth); location.href="login.html"; };

    let CURRENT_USER=null; let IS_ADMIN=false;

    onAuthStateChanged(auth, async (user)=>{
      if(!user){ location.href="login.html"; return; }
      CURRENT_USER=user;
      const u=await getDoc(doc(db,"users",user.uid));
      const role = u.exists()? (u.data().role||"member") : "member";
      IS_ADMIN = role==="admin";
      if(!IS_ADMIN){ location.href="projects.html"; return; }
      loadMembers();
    });

    async function loadMembers(){
      const snap = await getDocs(collection(db,"users"));
      membersTable.innerHTML='';
      snap.forEach(d=>{
        const data=d.data()||{};
        const row=document.createElement('tr');
        row.innerHTML=`
          <td>${data.name||'â€”'}</td>
          <td>${data.email||'â€”'}</td>
          <td>${data.role==='admin'?'Ù…Ø¯ÙŠØ±':'Ø¹Ø¶Ùˆ'}</td>
          <td><input type="color" value="${data.color||'#bc8f74'}" data-uid="${d.id}" class="userColor" style="width:40px;height:30px;border:0;"></td>
          <td>${data.active===false?'<span class="badge" style="background:#fdd">Ù…ÙˆÙ‚ÙˆÙ</span>':'<span class="badge">Ù†Ø´Ø·</span>'}</td>
          <td>
            <button class="btn secondary small" data-act="toggle" data-uid="${d.id}">${data.active===false?'ØªÙØ¹ÙŠÙ„':'Ø¥ÙŠÙ‚Ø§Ù'}</button>
            <button class="btn small" data-act="role" data-uid="${d.id}">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±</button>
          </td>
        `;
        membersTable.appendChild(row);
      });
    }

    // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø£Ùˆ Ø§Ù„Ø¯ÙˆØ± Ø£Ùˆ Ø§Ù„Ø­Ø§Ù„Ø©
    membersTable.addEventListener('change', async (e)=>{
      if(e.target.classList.contains('userColor')){
        const uid=e.target.dataset.uid;
        const val=e.target.value;
        await updateDoc(doc(db,'users',uid),{color:val});
      }
    });

    membersTable.addEventListener('click', async (e)=>{
      const uid=e.target.dataset.uid;
      if(!uid) return;
      const act=e.target.dataset.act;
      const ref=doc(db,'users',uid);
      const snap=await getDoc(ref);
      if(!snap.exists()) return;
      const data=snap.data();
      if(act==='toggle'){
        const newState=!(data.active===false);
        await updateDoc(ref,{active:newState});
      }
      if(act==='role'){
        const newRole=(data.role==='admin')?'member':'admin';
        await updateDoc(ref,{role:newRole});
      }
      loadMembers();
    });

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠÙ‹Ø§
    addBtn.onclick=async()=>{
      const email=prompt('ğŸ“§ Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯:'); if(!email) return;
      const password=prompt('ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØ©: (Ù„Ù† ØªÙØ±Ø³Ù„ Ø¢Ù„ÙŠÙ‹Ø§)'); if(!password) return;
      const name=prompt('ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ:')||email.split('@')[0];
      try{
        const cred = await createUserWithEmailAndPassword(auth, email, password);
        const id=cred.user.uid;
        await setDoc(doc(db,'users',id),{
          name,email,role:'member',color:'#bc8f74',active:true,createdAt:serverTimestamp()
        });
        alert('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­.');
        loadMembers();
      }catch(e){
        alert('âš ï¸ ÙØ´Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ©: '+e.message);
      }
    };
  </script>
<div class="mzj-overlay" id="mzjOverlay" aria-hidden="true"></div>
<aside class="mzj-sidebar" id="mzjSidebar" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©">
  <div class="mzj-sb-head">
    <div class="mzj-sb-logo">MZJ</div>
    <div><div class="mzj-sb-title">Workspace</div><div class="mzj-sb-sub">MZJ Cars</div></div>
  </div>
  <nav class="mzj-sb-nav">
    <a href="dashboard.html" class="mzj-nav-item "><svg viewBox="0 0 24 24"><path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-7H9v7H4a1 1 0 0 1-1-1z"/></svg><span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></a>
    <a href="projects.html" class="mzj-nav-item "><svg viewBox="0 0 24 24"><path d="M4 4h7v7H4zM13 4h7v7h-7zM4 13h7v7H4zM13 13h7v7h-7z"/></svg><span>Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</span></a>
    <a href="admin.html" class="mzj-nav-item"><svg viewBox="0 0 24 24"><path d="M3 7a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span></a>
    <a href="cars.html" class="mzj-nav-item "><svg viewBox="0 0 24 24"><path d="M3 16v-3l2-6h14l2 6v3"/><path d="M7 16v2M17 16v2"/><path d="M5 16h14"/><path d="M7 12h10"/></svg><span>Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</span></a>
    <a href="members.html" class="mzj-nav-item active "><svg viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><path d="M8 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/><path d="M22 21v-2a3 3 0 0 0-2-2.8"/><path d="M16 3.2a4 4 0 0 1 0 7.6"/></svg><span>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</span></a>
    <a href="Whiteboard.html" class="mzj-nav-item "><svg viewBox="0 0 24 24"><path d="M12 20h9"/><path d="M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4z"/></svg><span>ÙˆØ§ÙŠØª Ø¨ÙˆØ±Ø¯</span></a>
  </nav>
  <div class="mzj-sb-foot">
    <button class="mzj-sb-btn" id="mzjClose">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</aside>

<script>
(function(){
  const t=document.getElementById('mzjToggle');
  const o=document.getElementById('mzjOverlay');
  const s=document.getElementById('mzjSidebar');
  const c=document.getElementById('mzjClose');
  if(!t||!o||!s) return;

  function openSB(){
    o.style.display='block';
    requestAnimationFrame(()=>{
      o.classList.add('open');
      s.classList.add('open');
    });
  }
  function closeSB(){
    s.classList.remove('open');
    o.classList.remove('open');
    setTimeout(()=>{ o.style.display='none'; }, 180);
  }

  t.addEventListener('click', openSB);
  o.addEventListener('click', closeSB);
  if(c) c.addEventListener('click', closeSB);

  window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeSB(); });

  document.addEventListener('pointerdown', (e)=>{
    const el = e.target.closest('button, a');
    if(!el) return;
    el.classList.add('pressed');
    setTimeout(()=>el.classList.remove('pressed'), 180);
  });
})();
</script>


</body>
</html>

